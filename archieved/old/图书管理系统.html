<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-Hans">

<head>
    
    
    <title>图书管理系统--归零幻想的博客</title>
    <meta charset="UTF-8">
    <!--移动设备不缩放-->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="alternate" type="application/rss+xml" title="归零幻想" href="https://ntutn.top/rss.xml" />
    <!--github的markdown样式-->
    <link rel="stylesheet" href="/res/css/github-markdown.css">
    <!--一个基于bootstrap的样式-->
    <link rel="stylesheet" href="/res/css/main.css">

    <script src="/res/js/jquery.min.js"></script>
    <script src="/res/js/popper.min.js"></script>
    <script src="/res/js/bootstrap.min.js"></script>

    <style>
        /*图片缩放*/
        .imageWrapper {
            max-width: 500px;
            max-height: 100%;
            display: block;
            margin: 0 auto;
        }

        /*背景图片*/
        body {
            background: url(https://unsplash.it/1600/900?random);
            background-attachment: fixed;
            background-position: bottom center;
            background-size: cover;
        }
    </style>
    <script src="/res/js/zoomify.min.js"></script>
    <link href="/res/css/zoomify.min.css" rel="stylesheet">

    <!---代码高亮-->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js"></script>

    <script>
        $(document).ready(function () {
            $(".markdown-body img").each(function () {
                divImageWrapper = $(this).after("<div class='imageWrapper'></div>")
                $(this).appendTo($(this).next())
            })
            $(".markdown-body img").zoomify() // 图片缩放
            hljs.highlightAll() // 代码高亮
        })
    </script>
</head>

<body>
    <div class="container">
        <nav id="nav" class="navbar navbar-expand-lg navbar-light bg-light">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03"
                aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href="/"><img src="/res/logo.png" width="70" height="40"
                    class="d-inline-block align-top" alt="">
                <span>归零幻想的博客</span></a>

            <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                    <li id="n_home" class="nav-item">
                        <a class="nav-link" href="/">主页</a>
                    </li>
                    <!-- <li id="n_tags" class="nav-item">
                        <a class="nav-link" href="/tags">标签</a>
                    </li> -->
                    <li id="n_about" class="nav-item">
                        <a class="nav-link" href="https://channel.ntutn.workers.dev/" target="_blank">频道</a>
                    </li>
                    <li id="n_about" class="nav-item">
                        <a class="nav-link" href="/friends.html">友链</a>
                    </li>
                    <li id="n_about" class="nav-item">
                        <a class="nav-link" href="/about.html">关于</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/rss.xml">RSS</a>
                    </li>
                </ul>
            </div>
        </nav>
        <nav class="mt-3" aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/">Home</a></li>

                <li class="breadcrumb-item active" aria-current="page">图书管理系统</li>
            </ol>
        </nav>
        <div class="card mt-3 mb-3">
            <div class="card-body markdown-body">
                <h1 class="card-title text-center realtitle">图书管理系统</h1>
                <!--TODO 时间-->
                <h6 class="card-subtitle mb-2 text-muted text-center">
                    发布时间：<span>2019-04-13</span>&nbsp;
                    修改时间：<span>2019-04-13</span>&nbsp;
                    作者：<span>归零幻想</span>
                </h6>
                <br>
                <div class="card-text"><p>翻出了以前写的C++作业，图书管理系统，虽然挺简单的，但留下纪念下吧。</p>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include&lt;cstdlib&gt;
#include&lt;cstring&gt;
#include&lt;fstream&gt;

using namespace std;

class CUser
{
private:
    int code;      //表示用户编号；
    char name[20];  //表示用户姓名
public:
    CUser()
    {
        ;
    };   // 默认构造函数
    CUser(int id, char na[])
    {
        code=id;
        strcpy(name,na);
    };   //构造函数，初始化用户信息
    void setcode(int n)
    {
        code=n;
    };      //用来设置用户编号
    int getcode()
    {
        return code;
    };          //用来获取用户编号
    void setname(char na[])
    {
        strcpy(name,na);
    };  //用来设置用户姓名
    char* getname()
    {
        return name;
    };        //用来获取用户姓名
    void show()
    {
        cout&lt;&lt;&quot;用户编号：&quot;&lt;&lt;code&lt;&lt;endl;
        cout&lt;&lt;&quot;姓名：&quot;&lt;&lt;name&lt;&lt;endl;
    };           //用来显示用户的基本信息

};


class CBook
{

private:
    int code;              //图书编号
    char name[20];      //图书名称
    bool Is_Stock;          //true为在架，false为借出
    bool Is_Existing;       //true为存在, false为删除
public:
    CBook()
    {
        ;
    }; //默认构造函数
    CBook(int no,char na[])
    {
        code=no;
        strcpy(name,na);
        Is_Stock=true;
        Is_Existing=true;
    };    //构造函数，初始化图书信息
    void setcode(int n)
    {
        code=n;
    };   //设置图书编号
    int getcode()
    {
        return code;
    };    //获取图书编号
    void setname(char na[])
    {
        strcpy(name,na);
    };    //设置图书名称
    char* getname()
    {
        return name;
    };  //获取图书名称
    bool  get_Stock()
    {
        return Is_Stock;
    };  //获取图书是否在库信息
    void set_Stock(bool isstock)
    {
        Is_Stock=isstock;
    };// 设置图书是否在库信息
    bool  get_Existing()
    {
        return Is_Existing;
    };//获取存在标志
    void set_Existing(bool isex)
    {
        Is_Existing=isex;
    };//设置存在标志

};

class CReader:public CUser
{
private:
    bool Is_Existing;  //true存在，false删除
    bool Is_Borrowing;  //true借过书，false没有借书
    CBook brbook;     //表示读者所借的图书
public:
    CReader()
    {
        CUser();
    };   //构造函数，初始化读者信息
    CReader(int id, char na[])
    {
        CUser(id,na);
    };   //构造函数，初始化读者信息
    bool get_Existing()
    {
        return Is_Existing;
    };        //用来获取删除标志
    void set_Existing(bool isex)
    {
        Is_Existing=isex;
    };     //用来设置删除标志
    bool get_Borrowing()
    {
        return Is_Borrowing;
    };      //用来获取读者借阅情况
    void set_Borrowing(bool isbo)
    {
        Is_Borrowing=isbo;
    };   //用来设置读者借阅情况
    void setbrbook(CBook bt)
    {
        brbook=bt;
        Is_Borrowing=true;
    };  //用来记录读者结束信息
    CBook getbrbook()
    {
        return brbook;
    };     //用来获取读者结束信息
    void show()
    {
        CUser::show();
        if(Is_Borrowing)
        {
            cout&lt;&lt;&quot;当前借书：&quot;&lt;&lt;brbook.getname()&lt;&lt;endl;
        }
        else
        {
            cout&lt;&lt;&quot;当前用户没有借书！&quot;&lt;&lt;endl;
        }
    };               //重写基类成员，显示读者的基本信息情况和借书情况

};

class CReaderManager
{
private:
    CReader rdarray[50];// 存储读者信息的集合
    int top;      //当前数组中存储的读者数量
public:
    CReaderManager()
    {
        top=0;
    };  // 构造函数
    ~CReaderManager()
    {

    };   //析构函数
    void addreaders()
    {
        char tmp[20];
        int tmp_no;
        cout&lt;&lt;&quot;请输入读者的相关信息：&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;请输入读者的名称：&quot;&lt;&lt;endl;
        cin&gt;&gt;tmp;
        cout&lt;&lt;&quot;请输入读者的编号：&quot;&lt;&lt;endl;
        cin&gt;&gt;tmp_no;
        CReader tmp_reader(tmp_no,tmp);
        rdarray[top]=tmp_reader;
        top++;
        cout&lt;&lt;&quot;读者添加成功。&quot;&lt;&lt;endl;
    };          //添加读者
    int findreaders(int suffix)
    {
        for(int i=0; i&lt;top; i++)
        {
            if(rdarray[i].getcode()==suffix)
            {
                return i;//返回在库中的位置。
            }
        }
        return -1;//未找到
    };     //查找读者，这个函数用于借书还书操作。
    int findreaders()
    {
        char tmp[20];
        cout&lt;&lt;&quot;请输入需要查找的用户的名称：&quot;&lt;&lt;endl;
        cin&gt;&gt;tmp;
        for(int i=0; i&lt;top; i++)
        {
            if(strcmp(rdarray[i].getname(),tmp)==0)
            {
                return i;
            }
        }
        return -1;
    };            //查找读者，这个函数用于读者维护操作
    void editreaders()
    {
        char tmp[20];
        int code;
        int num=findreaders();
        int tmp_ex;
        if(num==-1)
        {
            cout&lt;&lt;&quot;您要的用户没有找到。&quot;&lt;&lt;endl;
            return;
        }
        cout&lt;&lt;&quot;用户姓名：&quot;&lt;&lt;rdarray[num].getname()&lt;&lt;endl;
        cout&lt;&lt;&quot;编号：&quot;&lt;&lt;rdarray[num].getcode()&lt;&lt;endl;
        if(rdarray[num].get_Borrowing())
        {
            cout&lt;&lt;&quot;用户借了&quot;&lt;&lt;rdarray[num].getbrbook().getname()&lt;&lt;endl;
        }
        else
        {
            cout&lt;&lt;&quot;用户没有借任何书。&quot;&lt;&lt;endl;
        }
        if(rdarray[num].get_Existing())
        {
            cout&lt;&lt;&quot;用户状态正常。&quot;&lt;&lt;endl;
        }
        else
        {
            cout&lt;&lt;&quot;用户已经被删除。&quot;&lt;&lt;endl;
        }
        cout&lt;&lt;&quot;请输入修改后的姓名：&quot;&lt;&lt;endl;
        cin&gt;&gt;tmp;
        rdarray[num].setname(tmp);
        cout&lt;&lt;&quot;请输入修改后的编号：&quot;&lt;&lt;endl;
        cin&gt;&gt;code;
        rdarray[num].setcode(code);
        if(!rdarray[num].get_Existing())
        {
            cout&lt;&lt;&quot;用户被标记为删除状态，是否恢复？(1恢复/0不恢复)&quot;&lt;&lt;endl;
            cin&gt;&gt;tmp_ex;
            rdarray[num].set_Existing(tmp_ex);
        }
    };          //编辑读者信息
    void delreaders()
    {
        int tmp_code;
        int num;
        cout&lt;&lt;&quot;请输入要删除的用户的编号：&quot;&lt;&lt;endl;
        cin&gt;&gt;tmp_code;
        num=findreaders(tmp_code);
        if(num==-1)
        {
            cout&lt;&lt;&quot;用户未找到，操作失败。&quot;&lt;&lt;endl;
            return;
        }
        if(!rdarray[num].get_Existing())
        {
            cout&lt;&lt;&quot;用户已经被删除，操作失败。&quot;&lt;&lt;endl;
            return;
        }
        if(!rdarray[num].get_Borrowing())
        {
            cout&lt;&lt;&quot;用户有书未还，操作失败。&quot;&lt;&lt;endl;
            return;
        }
        rdarray[num].set_Existing(false);
        cout&lt;&lt;&quot;用户删除完毕。&quot;&lt;&lt;endl;
    };          //删除读者，读者如果借书要还书后才能删除
    void listreaders()
    {
        for(int i=0; i&lt;top; i++)
        {
            if(rdarray[i].get_Existing())
            {
                cout&lt;&lt;rdarray[i].getcode()&lt;&lt;'\t'&lt;&lt;rdarray[i].getname()&lt;&lt;'\t';
                if(rdarray[i].get_Borrowing())
                {
                    cout&lt;&lt;rdarray[i].getbrbook().getname();
                }
                else
                {
                    cout&lt;&lt;&quot;未借书&quot;;
                }
                cout&lt;&lt;endl;
            }
        }
    };           //显示所有读者
    CReader&amp; getreader(int p)
    {
        if(p&lt;0||p&gt;=top)
        {
            cout&lt;&lt;&quot;下标越界。&quot;&lt;&lt;endl;
            p=0;
        }
        return rdarray[p];
    }

};

class CBookManager
{
private:
    CBook btarray[50];                   //图书集合
    int top;                         //当前数组中存储的图书数量
public:
    CBookManager()
    {
        top=0;
    };
    ~CBookManager()
    {
        ;
    };
    void addbooks()
    {
        char tmp[20];
        int tmp_no;
        cout&lt;&lt;&quot;请输入图书的相关信息：&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;请输入图书的名称：&quot;&lt;&lt;endl;
        cin&gt;&gt;tmp;
        cout&lt;&lt;&quot;请输入图书的编号：&quot;&lt;&lt;endl;
        cin&gt;&gt;tmp_no;
        CBook tmp_book(tmp_no,tmp);
        btarray[top]=tmp_book;
        top++;
        cout&lt;&lt;&quot;图书入库成功。&quot;&lt;&lt;endl;
    };    //添加图书
    int findbooks(int suffix)
    {
        for(int i=0; i&lt;top; i++)
        {
            if(btarray[i].getcode()==suffix)
            {
                return i;//返回图书在书库中的位置。
            }
        }
        return -1;//未找到图书
    };  //查找图书，这个函数用于借书还书操作
    int findbooks()
    {
        char tmp[20];
        cout&lt;&lt;&quot;请输入需要查找的图书的名称：&quot;&lt;&lt;endl;
        cin&gt;&gt;tmp;
        for(int i=0; i&lt;top; i++)
        {
            if(strcmp(btarray[i].getname(),tmp)==0)
            {
                return i;
            }
        }
        return -1;
    };  //查找图书，用于图书维护操作
    void editbooks()
    {
        char tmp[20];
        int code;
        int num=findbooks();
        int tmp_ex;
        if(num==-1)
        {
            cout&lt;&lt;&quot;您要的图书没有找到。&quot;&lt;&lt;endl;
            return;
        }
        cout&lt;&lt;&quot;图书名称：&quot;&lt;&lt;btarray[num].getname()&lt;&lt;endl;
        cout&lt;&lt;&quot;图书编号：&quot;&lt;&lt;btarray[num].getcode()&lt;&lt;endl;
        if(btarray[num].get_Stock())
        {
            cout&lt;&lt;&quot;图书在架。&quot;&lt;&lt;endl;
        }
        else
        {
            cout&lt;&lt;&quot;图书已经借出。&quot;&lt;&lt;endl;
        }
        if(btarray[num].get_Existing())
        {
            cout&lt;&lt;&quot;图书状态正常。&quot;&lt;&lt;endl;
        }
        else
        {
            cout&lt;&lt;&quot;图书已经被删除。&quot;&lt;&lt;endl;
        }
        cout&lt;&lt;&quot;请输入修改后的名称：&quot;&lt;&lt;endl;
        cin&gt;&gt;tmp;
        btarray[num].setname(tmp);
        cout&lt;&lt;&quot;请输入修改后的编号：&quot;&lt;&lt;endl;
        cin&gt;&gt;code;
        btarray[num].setcode(code);
        if(!btarray[num].get_Existing())
        {
            cout&lt;&lt;&quot;图书被标记为删除状态，是否恢复？(1恢复/0不恢复)&quot;&lt;&lt;endl;
            cin&gt;&gt;tmp_ex;
            btarray[num].set_Existing(tmp_ex);
        }
    };     //编辑图书
    void delbooks()
    {
        int tmp_code;
        int num;
        cout&lt;&lt;&quot;请输入要删除的图书的编号：&quot;&lt;&lt;endl;
        cin&gt;&gt;tmp_code;
        num=findbooks(tmp_code);
        if(num==-1)
        {
            cout&lt;&lt;&quot;图书未找到，操作失败。&quot;&lt;&lt;endl;
            return;
        }
        if(!btarray[num].get_Existing())
        {
            cout&lt;&lt;&quot;图书已经被删除，操作失败。&quot;&lt;&lt;endl;
            return;
        }
        if(!btarray[num].get_Stock())
        {
            cout&lt;&lt;&quot;图书被借出，操作失败。&quot;&lt;&lt;endl;
            return;
        }
        btarray[num].set_Existing(false);
        cout&lt;&lt;&quot;图书删除完毕。&quot;&lt;&lt;endl;
    };   //  删除图书
    void listbooks()
    {
        for(int i=0; i&lt;top; i++)
        {
            if(btarray[i].get_Stock()&amp;&amp;btarray[i].get_Existing())
            {
                cout&lt;&lt;btarray[i].getcode()&lt;&lt;'\t'&lt;&lt;btarray[i].getname()&lt;&lt;endl;
            }
        }
    } ;  //显示全部图书
    CBook&amp; getbook(int p)
    {
        if(p&lt;0||p&gt;=top)
        {
            cout&lt;&lt;&quot;下标越界。&quot;&lt;&lt;endl;
            p=0;
        }
        return btarray[p];
    }
};

int showmenu()
{
    char re=0;
    while(re&lt;'1'||re&gt;'6')
    {
        cout&lt;&lt;&quot;功能菜单&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;1.读者管理&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;2.借书管理&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;3.还书管理&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;4.图书管理&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;5.文件存储&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;6.退出&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;请输入对应序号并回车&quot;&lt;&lt;endl;
        cin&gt;&gt;re;
        //cout&lt;&lt;re;
    }
    return re-'0';
}

int showmenu1()
{
    int re=0;
    while(re&lt;1||re&gt;4)
    {
        cout&lt;&lt;&quot;功能菜单--读者管理&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;1.添加读者&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;2.删除读者&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;3.修改读者&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;4.查找读者&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;请输入对应序号并回车&quot;&lt;&lt;endl;
        cin&gt;&gt;re;
    }
    return re;
}

int showmenu4()
{
    int re=0;
    while(re&lt;1||re&gt;4)
    {
        cout&lt;&lt;&quot;功能菜单--图书管理&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;1.添加图书&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;2.删除图书&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;3.修改图书&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;4.查找图书&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;请输入对应序号并回车&quot;&lt;&lt;endl;
        cin&gt;&gt;re;
    }
    return re;
}

int showmenu5()
{
    int re=0;
    while(re&lt;1||re&gt;2)
    {
        cout&lt;&lt;&quot;功能菜单--文件存储&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;1.读取&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;2.保存&quot;&lt;&lt;endl;
        cout&lt;&lt;&quot;请输入对应序号并回车&quot;&lt;&lt;endl;
        cin&gt;&gt;re;
    }
    return re;
}

int main()
{
    CReaderManager cm1;
    CBookManager cb1;
    ofstream file;
    ifstream file2;
    int cz=0;
    int tmp_us;
    int tmp_bo;
    while(true)
    {
        cz=showmenu();
        switch(cz)
        {
        case 1:
            cz=showmenu1();
            switch(cz)
            {
            case 1:
                cm1.addreaders();
                break;
            case 2:
                cm1.delreaders();
                break;
            case 3:
                cm1.editreaders();
                break;
            case 4:
                cm1.findreaders();
                break;
            }
            break;
        case 2:
            tmp_bo=cb1.findbooks();
            if(tmp_bo==-1)
            {
                cout&lt;&lt;&quot;您要借的书没有找到。&quot;&lt;&lt;endl;
                break;
            }
            if(!cb1.getbook(tmp_bo).get_Existing())
            {
                cout&lt;&lt;&quot;您要借的书已经被删除，操作失败。&quot;&lt;&lt;endl;
                break;
            }
            if(!cb1.getbook(tmp_bo).get_Stock())
            {
                cout&lt;&lt;&quot;您要借的书已经被借出，操作失败。&quot;&lt;&lt;endl;
                break;
            }
            tmp_us=cm1.findreaders();
            if(tmp_bo==-1)
            {
                cout&lt;&lt;&quot;您使用的身份无效。&quot;&lt;&lt;endl;
                break;
            }
            if(!cm1.getreader(tmp_us).get_Existing())
            {
                cout&lt;&lt;&quot;您的账户已经被管理员删除。&quot;&lt;&lt;endl;
                break;
            }
            if(cm1.getreader((tmp_us)).get_Borrowing())
            {
                cout&lt;&lt;&quot;请把您借的书还了再借。&quot;&lt;&lt;endl;
                break;
            }
            cm1.getreader(tmp_us).set_Borrowing(true);
            cm1.getreader(tmp_us).setbrbook(cb1.getbook(tmp_bo));
            cb1.getbook(tmp_bo).set_Stock(false);
            break;
        case 3:
            cm1.editreaders();
        case 4:
            cz=showmenu4();
            switch(cz)
            {
            case 1:
                cb1.addbooks();
                break;
            case 2:
                cb1.delbooks();
                break;
            case 3:
                cb1.editbooks();
                break;
            case 4:
                cb1.findbooks();
                break;
            }
            break;
        case 5:
            cz=showmenu5();
            switch(cz)
            {
            case 1:
                file2.open(&quot;cb1.dat&quot;,ios::binary);
                //二进制打开，缺省为文本，ios::out,ios::in,文本输入输出用&lt;&lt;,&gt;&gt;
                file2.read((char *)&amp;cb1,sizeof(cb1));
                ///int num=file2.gcount(); //获取读到文件的大小
                file2.close();
                file2.open(&quot;cm1.dat&quot;,ios::binary);
                //二进制打开，缺省为文本，ios::out,ios::in,文本输入输出用&lt;&lt;,&gt;&gt;
                file2.read((char *)&amp;cm1,sizeof(cm1));
                ///int num=file2.gcount(); //获取读到文件的大小
                file2.close();

                break;
            case 2:
                file.open(&quot;cb1.dat&quot;,ios::binary);
                //缓存的类型是 unsigned char *，需要类型转换
                file.write((char *)&amp;cb1,sizeof(cb1));  //winServer为类对象
                file.close();
                file.open(&quot;cm1.dat&quot;,ios::binary);
                //缓存的类型是 unsigned char *，需要类型转换
                file.write((char *)&amp;cm1,sizeof(cm1));  //winServer为类对象
                file.close();
                break;
            }
            break;
        case 6:
            exit(0);
            break;
        }
    }
    return 0;
}
</code></pre>
</div>
            </div>
            <script src="https://utteranc.es/client.js" repo="zerofancy/zerofancy.github.io" issue-term="图书管理系统" theme="github-light" crossorigin="anonymous" async>
                </script>
        </div>
        <!-- 页脚 -->
        <footer class="navbar navbar-light bg-light">
            <p>版权所有：归零幻想 ┊ 备案号：<a href="http://beian.miit.gov.cn/">暂无</a>┊ Powered by：归零幻想</p>
        </footer>
    </div>
</body>

</html>